var DM=DM||{};DM.NewsScroller=function(){var r="",l=null,e=null,o=null,n=null,s=0,c=1;$(function(){r=$("#rel_url").val(),e=$(".section-scroller"),l=e.parents(".section-scroller-wrapper"),o=$(".scroll-loading"),n=$(".scroll-more-btn"),e.scroll(function(){e.scrollTop()>=e[0].scrollHeight-e.height()&&i()}),n.click(function(){i()}),i()});var i=function(){if(c){var l=e[0].scrollHeight-20;n.hide(),o.show(),$.ajax({type:"post",url:r+"includes/ajax/get-news-stories.php",dataType:"json",data:{current_max:s},success:function(r){o.hide(),"error"in r?t(r.error):(s=r.current_max,e.append(r.success),$(".small-news-item").fadeIn(100),r["more-stories"]||(l+=20),e.scrollTop(l),r["more-stories"]?n.show():(e.unbind("scroll"),c=0))},error:function(r,l,e){o.hide();var n=l+"<br>"+e;t(n)}})}},t=function(r){e.html('<div class="error">'+r+"</div>")}}();