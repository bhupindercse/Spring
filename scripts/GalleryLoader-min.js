var DM=DM||{};DM.LoadScript=function(){var t=function(t,a){var e=document.createElement("script");a&&e.addEventListener("load",a),e.async=!0,e.src=t,document.querySelector("body").appendChild(e)},a=function(t,a){var e=document.createElement("link");a&&e.addEventListener("load",a),e.href=t,e.rel="stylesheet",document.querySelector("head").appendChild(e)};return{loadScript:t,loadCSS:a}}();var DM=DM||{};DM.GalleryLoader=function(){var t="",a="",e=!1,r=!1,l=function(){t=$("#base_url").html(),a=$("#currentGallery").val(),n(),$(".gallery-btn").click(function(){c($(this))})},n=function(){var t={},a=$(".gallery-thumbs .gallery-thumbnail").length;a&&!r&&(DM.LoadScript.loadScript("scripts/libs/fancybox-2.5.1/lib/jquery.mousewheel-3.0.6.pack.js"),DM.LoadScript.loadCSS("scripts/libs/fancybox-2.5.1/source/jquery.fancybox.css"),DM.LoadScript.loadScript("scripts/libs/fancybox-2.5.1/source/jquery.fancybox.pack.js",DM.GalleryLoader.fancyboxLoaded),r=!0),$.each($(".gallery-thumbs .gallery-thumbnail"),function(a,e){var r=$(e).attr("data-src"),l=$(e).attr("data-thumb"),n=$(e).attr("data-gallery"),i=$(e).attr("data-title"),c=$('<a class="fancybox" href="'+r+'" rel="'+n+'" title="'+i+'"><img src="'+l+'" alt="'+l+'"></a>');t[a]={},t[a].element=$(e),t[a].thumb=c;var o=new Image;o.onload=function(){var a=$(this),e=t[a.attr("alt")].element;e.fadeOut(100,function(){$(this).find("img").remove(),$(this).append(t[a.attr("alt")].thumb),$(this).fadeIn(200)})},o.alt=a,o.src=l})},i=function(){$(".fancybox").fancybox({helpers:{title:{type:"inside"}}})},c=function(a){if(!a.hasClass("active")){var e=a.attr("data-permalink");$(".gallery-btn.active").removeClass("active"),a.addClass("active");var r=$(".gallery-thumbs");r.css("height",$(".gallery-thumbs").outerHeight()),r.find("img").fadeOut(100),$.ajax({type:"post",url:t+"includes/ajax/get-gallery-images.php",dataType:"json",data:{permalink:e},success:function(t){"error"in t?(r.html(t.error),o()):(r.html(t.html).find(".gallery-thumbnail").hide(),o(!0))},error:function(t,a,e){r.html('<div class="error">'+a+"<br>"+e+"</div>"),o()}})}},o=function(t){var a=$(".gallery-thumbs"),e=a.find(".gallery-thumbnail"),r=a.outerHeight();e.show(),a.css("height","");var l=a.outerHeight();e.hide(),a.css("height",r),a.animate({height:l},100,function(){a.css("height",""),"undefined"!=typeof t&&t&&n()})};return{init:l,fancyboxLoaded:i}}();