/*
* jQuery timepicker addon
* By: Trent Richardson [http://trentrichardson.com]
* Version 0.9.6
* Last Modified: 07/20/2011
* 
* Copyright 2011 Trent Richardson
* Dual licensed under the MIT and GPL licenses.
* http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
* http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
* 
* HERES THE CSS:
* .ui-timepicker-div .ui-widget-header{ margin-bottom: 8px; }
* .ui-timepicker-div dl{ text-align: left; }
* .ui-timepicker-div dl dt{ height: 25px; }
* .ui-timepicker-div dl dd{ margin: -25px 10px 10px 65px; }
* .ui-timepicker-div td { font-size: 90%; }
*/(function($){function Timepicker(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",ampm:!1,timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",timezoneText:"Time Zone"};this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showTimezone:!1,showTime:!0,stepHour:.05,stepMinute:.05,stepSecond:.05,hour:0,minute:0,second:0,timezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,hourMax:23,minuteMax:59,secondMax:59,minDateTime:null,maxDateTime:null,hourGrid:0,minuteGrid:0,secondGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,showTimepicker:!0,timezoneList:["-1100","-1000","-0900","-0800","-0700","-0600","-0500","-0400","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0400","+0500","+0600","+0700","+0800","+0900","+1000","+1100","+1200"]};$.extend(this._defaults,this.regional[""])}function extendRemove(e,t){$.extend(e,t);for(var n in t)if(t[n]===null||t[n]===undefined)e[n]=t[n];return e}$.extend($.ui,{timepicker:{version:"0.9.6"}});$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,timezone_select:null,hour:0,minute:0,second:0,timezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:["-1100","-1000","-0900","-0800","-0700","-0600","-0500","-0400","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0400","+0500","+0600","+0700","+0800","+0900","+1000","+1100","+1200"],setDefaults:function(e){extendRemove(this._defaults,e||{});return this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(e,t){$.isFunction(o.beforeShow)&&o.beforeShow(e,t,tp_inst)},onChangeMonthYear:function(e,t,n){tp_inst._updateDateTime(n);$.isFunction(o.onChangeMonthYear)&&o.onChangeMonthYear.call($input[0],e,t,n,tp_inst)},onClose:function(e,t){tp_inst.timeDefined===!0&&$input.val()!=""&&tp_inst._updateDateTime(t);$.isFunction(o.onClose)&&o.onClose.call($input[0],e,t,tp_inst)},timepicker:tp_inst});tp_inst.hour=tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second;tp_inst.ampm="";tp_inst.$input=$input;o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")}));tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime()));tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime()));tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime()));tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime()));return tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t);this._limitMinMaxDateTime(e,!1);this._injectTimePicker()},_parseTime:function(e,t){var n=this._defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/t{1,2}/ig,"(am|pm|a|p)?").replace(/z{1}/ig,"((\\+|-)\\d\\d\\d\\d)?").replace(/\s/g,"\\s?")+this._defaults.timeSuffix+"$",r=this._getFormatPositions(),i;this.inst||(this.inst=$.datepicker._getInst(this.$input[0]));if(t||!this._defaults.timeOnly){var s=$.datepicker._get(this.inst,"dateFormat"),o=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");n=".{"+s.length+",}"+this._defaults.separator.replace(o,"\\$&")+n}i=e.match(new RegExp(n,"i"));if(i){r.t!==-1&&(this.ampm=(i[r.t]===undefined||i[r.t].length===0?"":i[r.t].charAt(0).toUpperCase()=="A"?"AM":"PM").toUpperCase());r.h!==-1&&(this.ampm=="AM"&&i[r.h]=="12"?this.hour=0:this.ampm=="PM"&&i[r.h]!="12"?this.hour=(parseFloat(i[r.h])+12).toFixed(0):this.hour=Number(i[r.h]));r.m!==-1&&(this.minute=Number(i[r.m]));r.s!==-1&&(this.second=Number(i[r.s]));r.z!==-1&&(this.timezone=i[r.z]);return!0}return!1},_getFormatPositions:function(){var e=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|t{1,2}|z)/g),t={h:-1,m:-1,s:-1,t:-1,z:-1};if(e)for(var n=0;n<e.length;n++)t[e[n].toString().charAt(0)]==-1&&(t[e[n].toString().charAt(0)]=n+1);return t},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this._defaults,n=this,r=(t.hourMax-t.hourMax%t.stepHour).toFixed(0),i=(t.minuteMax-t.minuteMax%t.stepMinute).toFixed(0),s=(t.secondMax-t.secondMax%t.stepSecond).toFixed(0),o=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if(e.find("div#ui-timepicker-div-"+o).length===0&&t.showTimepicker){var u=' style="display:none;"',a='<div class="ui-timepicker-div" id="ui-timepicker-div-'+o+'"><dl>'+'<dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+o+'"'+(t.showTime?"":u)+">"+t.timeText+"</dt>"+'<dd class="ui_tpicker_time" id="ui_tpicker_time_'+o+'"'+(t.showTime?"":u)+"></dd>"+'<dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+o+'"'+(t.showHour?"":u)+">"+t.hourText+"</dt>",f=0,l=0,c=0,h;if(t.showHour&&t.hourGrid>0){a+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+o+'"'+(t.showHour?"":u)+"></div>"+'<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var p=t.hourMin;p<=r;p+=t.hourGrid){f++;var d=t.ampm&&p>12?p-12:p;d<10&&(d="0"+d);t.ampm&&(p==0?d="12a":p<12?d+="a":d+="p");a+="<td>"+d+"</td>"}a+="</tr></table></div></dd>"}else a+='<dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+o+'"'+(t.showHour?"":u)+"></dd>";a+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+o+'"'+(t.showMinute?"":u)+">"+t.minuteText+"</dt>";if(t.showMinute&&t.minuteGrid>0){a+='<dd class="ui_tpicker_minute ui_tpicker_minute_'+t.minuteGrid+'">'+'<div id="ui_tpicker_minute_'+o+'"'+(t.showMinute?"":u)+"></div>"+'<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var v=t.minuteMin;v<=i;v+=t.minuteGrid){l++;a+="<td>"+(v<10?"0":"")+v+"</td>"}a+="</tr></table></div></dd>"}else a+='<dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+o+'"'+(t.showMinute?"":u)+"></dd>";a+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+o+'"'+(t.showSecond?"":u)+">"+t.secondText+"</dt>";if(t.showSecond&&t.secondGrid>0){a+='<dd class="ui_tpicker_second ui_tpicker_second_'+t.secondGrid+'">'+'<div id="ui_tpicker_second_'+o+'"'+(t.showSecond?"":u)+"></div>"+'<div style="padding-left: 1px"><table><tr>';for(var m=t.secondMin;m<=s;m+=t.secondGrid){c++;a+="<td>"+(m<10?"0":"")+m+"</td>"}a+="</tr></table></div></dd>"}else a+='<dd class="ui_tpicker_second" id="ui_tpicker_second_'+o+'"'+(t.showSecond?"":u)+"></dd>";a+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+o+'"'+(t.showTimezone?"":u)+">"+t.timezoneText+"</dt>";a+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+o+'"'+(t.showTimezone?"":u)+"></dd>";a+="</dl></div>";$tp=$(a);if(t.timeOnly===!0){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div>"+"</div>");e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}this.hour_slider=$tp.find("#ui_tpicker_hour_"+o).slider({orientation:"horizontal",value:this.hour,min:t.hourMin,max:r,step:t.stepHour,slide:function(e,t){n.hour_slider.slider("option","value",t.value);n._onTimeChange()}});this.minute_slider=$tp.find("#ui_tpicker_minute_"+o).slider({orientation:"horizontal",value:this.minute,min:t.minuteMin,max:i,step:t.stepMinute,slide:function(e,t){n.minute_slider.slider("option","value",t.value);n._onTimeChange()}});this.second_slider=$tp.find("#ui_tpicker_second_"+o).slider({orientation:"horizontal",value:this.second,min:t.secondMin,max:s,step:t.stepSecond,slide:function(e,t){n.second_slider.slider("option","value",t.value);n._onTimeChange()}});this.timezone_select=$tp.find("#ui_tpicker_timezone_"+o).append("<select></select>").find("select");$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val(typeof e=="object"?e.value:e).text(typeof e=="object"?e.label:e)}));this.timezone_select.val(typeof this.timezone!="undefined"&&this.timezone!=null&&this.timezone!=""?this.timezone:t.timezone);this.timezone_select.change(function(){n._onTimeChange()});if(t.showHour&&t.hourGrid>0){h=100*f*t.hourGrid/(r-t.hourMin);$tp.find(".ui_tpicker_hour table").css({width:h+"%",marginLeft:h/(-2*f)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){var e=$(this).html();if(t.ampm){var r=e.substring(2).toLowerCase(),i=parseInt(e.substring(0,2),10);r=="a"?i==12?e=0:e=i:i==12?e=12:e=i+12}n.hour_slider.slider("option","value",e);n._onTimeChange();n._onSelectHandler()}).css({cursor:"pointer",width:100/f+"%",textAlign:"center",overflow:"hidden"})})}if(t.showMinute&&t.minuteGrid>0){h=100*l*t.minuteGrid/(i-t.minuteMin);$tp.find(".ui_tpicker_minute table").css({width:h+"%",marginLeft:h/(-2*l)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){n.minute_slider.slider("option","value",$(this).html());n._onTimeChange();n._onSelectHandler()}).css({cursor:"pointer",width:100/l+"%",textAlign:"center",overflow:"hidden"})})}t.showSecond&&t.secondGrid>0&&$tp.find(".ui_tpicker_second table").css({width:h+"%",marginLeft:h/(-2*c)+"%",borderCollapse:"collapse"}).find("td").each(function(e){$(this).click(function(){n.second_slider.slider("option","value",$(this).html());n._onTimeChange();n._onSelectHandler()}).css({cursor:"pointer",width:100/c+"%",textAlign:"center",overflow:"hidden"})});var g=e.find(".ui-datepicker-buttonpane");g.length?g.before($tp):e.append($tp);this.$timeObj=$tp.find("#ui_tpicker_time_"+o);if(this.inst!==null){var y=this.timeDefined;this._onTimeChange();this.timeDefined=y}var b=function(){n._onSelectHandler()};this.hour_slider.bind("slidestop",b);this.minute_slider.bind("slidestop",b);this.second_slider.bind("slidestop",b)}},_limitMinMaxDateTime:function(e,t){var n=this._defaults,r=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(!this._defaults.showTimepicker)return;if($.datepicker._get(e,"minDateTime")!==null&&r){var i=$.datepicker._get(e,"minDateTime"),s=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null){this.hourMinOriginal=n.hourMin;this.minuteMinOriginal=n.minuteMin;this.secondMinOriginal=n.secondMin}if(e.settings.timeOnly||s.getTime()==r.getTime()){this._defaults.hourMin=i.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=i.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=i.getSeconds()}else{this.second<this._defaults.secondMin&&(this.second=this._defaults.secondMin);this._defaults.secondMin=this.secondMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal}}if($.datepicker._get(e,"maxDateTime")!==null&&r){var o=$.datepicker._get(e,"maxDateTime"),u=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null){this.hourMaxOriginal=n.hourMax;this.minuteMaxOriginal=n.minuteMax;this.secondMaxOriginal=n.secondMax}if(e.settings.timeOnly||u.getTime()==r.getTime()){this._defaults.hourMax=o.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=o.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=o.getSeconds()}else{this.second>this._defaults.secondMax&&(this.second=this._defaults.secondMax);this._defaults.secondMax=this.secondMaxOriginal}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal}}if(t!==undefined&&t===!0){var a=(this._defaults.hourMax-this._defaults.hourMax%this._defaults.stepHour).toFixed(0),f=(this._defaults.minuteMax-this._defaults.minuteMax%this._defaults.stepMinute).toFixed(0),l=(this._defaults.secondMax-this._defaults.secondMax%this._defaults.stepSecond).toFixed(0);this.hour_slider&&this.hour_slider.slider("option",{min:this._defaults.hourMin,max:a}).slider("value",this.hour);this.minute_slider&&this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:f}).slider("value",this.minute);this.second_slider&&this.second_slider.slider("option",{min:this._defaults.secondMin,max:l}).slider("value",this.second)}},_onTimeChange:function(){var e=this.hour_slider?this.hour_slider.slider("value"):!1,t=this.minute_slider?this.minute_slider.slider("value"):!1,n=this.second_slider?this.second_slider.slider("value"):!1,r=this.timezone_select?this.timezone_select.val():!1;typeof e=="object"&&(e=!1);typeof t=="object"&&(t=!1);typeof n=="object"&&(n=!1);typeof r=="object"&&(r=!1);e!==!1&&(e=parseInt(e,10));t!==!1&&(t=parseInt(t,10));n!==!1&&(n=parseInt(n,10));var i=e<12?"AM":"PM",s=e!=this.hour||t!=this.minute||n!=this.second||this.ampm.length>0&&this.ampm!=i||r!=this.timezone;if(s){e!==!1&&(this.hour=e);t!==!1&&(this.minute=t);n!==!1&&(this.second=n);r!==!1&&(this.timezone=r);this.inst||(this.inst=$.datepicker._getInst(this.$input[0]));this._limitMinMaxDateTime(this.inst,!0)}this._defaults.ampm&&(this.ampm=i);this._formatTime();this.$timeObj&&this.$timeObj.text(this.formattedTime+this._defaults.timeSuffix);this.timeDefined=!0;s&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_formatTime:function(e,t,n){n==undefined&&(n=this._defaults.ampm);e=e||{hour:this.hour,minute:this.minute,second:this.second,ampm:this.ampm,timezone:this.timezone};var r=t||this._defaults.timeFormat.toString();if(n){var i=e.ampm=="AM"?e.hour:e.hour%12;i=Number(i)===0?12:i;r=r.toString().replace(/hh/g,(i<10?"0":"")+i).replace(/h/g,i).replace(/mm/g,(e.minute<10?"0":"")+e.minute).replace(/m/g,e.minute).replace(/ss/g,(e.second<10?"0":"")+e.second).replace(/s/g,e.second).replace(/TT/g,e.ampm.toUpperCase()).replace(/Tt/g,e.ampm.toUpperCase()).replace(/tT/g,e.ampm.toLowerCase()).replace(/tt/g,e.ampm.toLowerCase()).replace(/T/g,e.ampm.charAt(0).toUpperCase()).replace(/t/g,e.ampm.charAt(0).toLowerCase()).replace(/z/g,e.timezone)}else{r=r.toString().replace(/hh/g,(e.hour<10?"0":"")+e.hour).replace(/h/g,e.hour).replace(/mm/g,(e.minute<10?"0":"")+e.minute).replace(/m/g,e.minute).replace(/ss/g,(e.second<10?"0":"")+e.second).replace(/s/g,e.second).replace(/z/g,e.timezone);r=$.trim(r.replace(/t/gi,""))}if(arguments.length)return r;this.formattedTime=r},_updateDateTime:function(e){e=this.inst||e,dt=new Date(e.selectedYear,e.selectedMonth,e.selectedDay),dateFmt=$.datepicker._get(e,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(e),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,dt===null?new Date:dt,formatCfg);var t=this.formattedDate;if(e.lastVal!==undefined&&e.lastVal.length>0&&this.$input.val().length===0)return;this._defaults.timeOnly===!0?t=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||timeAvailable)&&(t+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix);this.formattedDateTime=t;if(!this._defaults.showTimepicker)this.$input.val(this.formattedDate);else if(this.$altInput&&this._defaults.altFieldTimeOnly===!0){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else if(this.$altInput){this.$altInput.val(t);this.$input.val(t)}else this.$input.val(t);this.$input.trigger("change")}});$.fn.extend({timepicker:function(e){e=e||{};var t=arguments;typeof e=="object"&&(t[0]=$.extend(e,{timeOnly:!0}));return $(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){e=e||{};var t=this,n=arguments;return typeof e=="string"?e=="getDate"?$.fn.datepicker.apply($(this[0]),n):this.each(function(){var e=$(this);e.datepicker.apply(e,n)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}});$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(e,t){var n=this._getInst($(e)[0]),r=this._get(n,"timepicker");if(r){r._limitMinMaxDateTime(n,!0);n.inline=n.stay_open=!0;this._base_selectDate(e,t+r._defaults.separator+r.formattedTime+r._defaults.timeSuffix);n.inline=n.stay_open=!1;this._notifyChange(n);this._updateDatepicker(n)}else this._base_selectDate(e,t)};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(e){var t=e.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t)return;if(typeof e.stay_open!="boolean"||e.stay_open===!1){this._base_updateDatepicker(e);var n=this._get(e,"timepicker");n&&n._addTimePicker(e)}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&$.datepicker._get(t,"constrainInput")){var r=n._defaults.ampm,i=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),s=n._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+n._defaults.separator+n._defaults.timeSuffix+(n._defaults.showTimezone?n._defaults.timezoneList.join(""):"")+i,o=String.fromCharCode(e.charCode===undefined?e.keyCode:e.charCode);return e.ctrlKey||o<" "||!i||s.indexOf(o)>-1}return $.datepicker._base_doKeyPress(e)};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&n._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(r){$.datepicker.log(r)}return $.datepicker._base_doKeyUp(e)};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(e){this._base_gotoToday(e);this._setTime(this._getInst($(e)[0]),new Date)};$.datepicker._disableTimepickerDatepicker=function(e,t,n){var r=this._getInst(e),i=this._get(r,"timepicker");$(e).datepicker("getDate");if(i){i._defaults.showTimepicker=!1;i._updateDateTime(r)}};$.datepicker._enableTimepickerDatepicker=function(e,t,n){var r=this._getInst(e),i=this._get(r,"timepicker");$(e).datepicker("getDate");if(i){i._defaults.showTimepicker=!0;i._addTimePicker(r);i._updateDateTime(r)}};$.datepicker._setTime=function(e,t){var n=this._get(e,"timepicker");if(n){var r=n._defaults,i=t?t.getHours():r.hour,s=t?t.getMinutes():r.minute,o=t?t.getSeconds():r.second;if(i<r.hourMin||i>r.hourMax||s<r.minuteMin||s>r.minuteMax||o<r.secondMin||o>r.secondMax){i=r.hourMin;s=r.minuteMin;o=r.secondMin}n.hour=i;n.minute=s;n.second=o;n.hour_slider&&n.hour_slider.slider("value",i);n.minute_slider&&n.minute_slider.slider("value",s);n.second_slider&&n.second_slider.slider("value",o);n._onTimeChange();n._updateDateTime(e)}};$.datepicker._setTimeDatepicker=function(e,t,n){var r=this._getInst(e),i=this._get(r,"timepicker");if(i){this._setDateFromField(r);var s;if(t){if(typeof t=="string"){i._parseTime(t,n);s=new Date;s.setHours(i.hour,i.minute,i.second)}else s=new Date(t.getTime());s.toString()=="Invalid Date"&&(s=undefined);this._setTime(r,s)}}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(e,t){var n=this._getInst(e),r=t instanceof Date?new Date(t.getTime()):t;this._updateDatepicker(n);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(e,r,!0)};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(e,t){var n=this._getInst(e),r=this._get(n,"timepicker");if(r){this._setDateFromField(n,t);var i=this._getDate(n);i&&r._parseTime($(e).val(),r.timeOnly)&&i.setHours(r.hour,r.minute,r.second);return i}return this._base_getDateDatepicker(e,t)};$.datepicker._base_parseDate=$.datepicker.parseDate;$.datepicker.parseDate=function(e,t,n){var r;try{r=this._base_parseDate(e,t,n)}catch(i){r=this._base_parseDate(e,t.substring(0,t.length-(i.length-i.indexOf(":")-2)),n)}return r};$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker;$.datepicker._optionDatepicker=function(e,t,n){this._base_optionDatepicker(e,t,n);var r=this._getInst(e),i=this._get(r,"timepicker");if(i){if(t==="minDate"){i._defaults.minDate!==undefined&&i._defaults.minDate instanceof Date&&(i._defaults.minDateTime=new Date(n));i._defaults.minDateTime!==undefined&&i._defaults.minDateTime instanceof Date&&(i._defaults.minDate=new Date(i._defaults.minDateTime.getTime()));i._limitMinMaxDateTime(r,!0)}if(t==="maxDate"){i._defaults.maxDate!==undefined&&i._defaults.maxDate instanceof Date&&(i._defaults.maxDateTime=new Date(n));i._defaults.maxDateTime!==undefined&&i._defaults.maxDateTime instanceof Date&&(i._defaults.maxDate=new Date(i._defaults.maxDateTime.getTime()));i._limitMinMaxDateTime(r,!0)}}};$.timepicker=new Timepicker;$.timepicker.version="0.9.6"})(jQuery);